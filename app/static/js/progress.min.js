function addProgressItemRow(){"use strict";var e=$('<tr class="progressItem"><td><textarea name="name" class="input-progress-item-name form-control" required></textarea></td><td style="vertical-align: middle;"><input type="text" name="amount" class="input-progress-item-value form-control" required data-parsley-type="number"/></td><td style="width:150px;text-align:center;vertical-align:middle"><a href="javascript:void(0)" class="add-progress-item-row" onclick="addProgressItemRow();"><i class="fa fa-plus"></i> Add</a> / <a href="javascript:void(0)" class="delete-progress-item-row" onclick="deleteProgressItemRow(this);"><i class="fa fa-minus"></i> Delete</a></td></tr>');$("#progressItems").append(e)}function deleteProgressItemRow(e){"use strict";$(e).closest("tr").remove()}function onClickUp(e){"use strict";var t=$(e).closest("tr"),a=t.prev();0!==a.length&&t.after(a),$("#btn-save").prop("disabled",!1)}function onClickDown(e){"use strict";var t=$(e).closest("tr"),a=t.next();0!==a.length&&t.before(a),$("#btn-save").prop("disabled",!1)}function reorderFormatter(e,t,a){"use strict";return'<div style="text-align: middle"><a href="javascript:void(0)" onclick="onClickUp(this);"><i class="fa fa-caret-up"></i> </a><a href="javascript:void(0)" onclick="onClickDown(this);"><i class="fa fa-caret-down"></i> </a></div>'}function paddingFormatterA(e,t,a){"use strict";return e.toFixed(2)}function paddingFormatterB(e,t,a){"use strict";return e.toFixed(2)}function percentageFormatter(e,t,a){"use strict";return(100*e).toFixed(2)+"%"}var metaData=$("#project-data").data(),deleteProjectUrl=metaData.deleteProjectUrl,editProjectUrl=metaData.editProjectUrl,getProjectProgressItemsUrl=metaData.getProjectProgressItemsUrl,newProgressItemUrl=metaData.newProgressItemUrl,projectActive=metaData.projectActive,projectAdminFee=metaData.projectAdminFee,projectId=metaData.projectId,projectMargin=metaData.projectMargin,projectName=metaData.projectName;$.ajax({url:getProjectProgressItemsUrl,type:"GET",contentType:"application/json; charset=utf-8"}).done(function(e){"use strict";$("#table").bootstrapTable({columns:[{checkbox:!0},{field:"name",title:"Name",halign:"center",editable:{type:"text"},sortable:!0},{field:"contract_value",title:"Contract Value",halign:"center",editable:{type:"text"},align:"right",sortable:!0},{field:"completed_value",title:"Completed To Date",halign:"center",editable:{type:"text"},align:"right",sortable:!0},{field:"percentage",title:"%",halign:"center",sortable:!0,formatter:"percentageFormatter",align:"right",valign:"center",width:"100px"},{title:"Action",align:"center",formatter:"reorderFormatter",width:"100px"}],data:e.progress_items,rowStyle:"rowStyle",toolbar:"#toolbar"})}),$.fn.editable.defaults.mode="inline",$("#btn-delete").on("click",function(){"use strict";swal({title:"Are you sure to delete selected rows?",text:"You cannot recover them later!",type:"warning",showCancelButton:!0,confirmButtonColor:"teal",confirmButtonText:"Yes, save them!",cancelButtonText:"No, cancel plx!",closeOnConfirm:!1,closeOnCancel:!1,customClass:"deleteRowsConfirmation"},function(e){if(!e)return void swal("Cancelled","Your project is safe :)","error");for(var t=!0,a=$table.bootstrapTable("getSelections"),r=0;r<a.length;r+=1)$.ajax({url:"/api/v1.0/progress_items/"+a[r].id,type:"DELETE",contentType:"application/json; charset=utf-8",dataType:"json"}).fail(function(){t=!1});t&&swal({title:"Nice!",text:"Delete variations",type:"success"},function(){location.reload()})})}),$("#btn-save").on("click",function(){"use strict";swal({title:"Are you sure to save all the changes?",type:"info",showCancelButton:!0,confirmButtonColor:"teal",confirmButtonText:"Yes, save them!",cancelButtonText:"No, cancel plx!",closeOnConfirm:!1,closeOnCancel:!1,customClass:"saveVariationsConfirmation"},function(e){if(!e)return void swal("Cancelled","Your saves are unsaved","error");for(var t=$table.bootstrapTable("getData"),a=0;a<t.length;a+=1){var r=t[a],o=r.id,n=r.name,s=r.contract_value,i=r.completed_value;$.ajax({url:"/api/v1.0/progress_items/"+o,type:"PUT",data:JSON.stringify({name:n,contract_value:s,completed_value:i}),contentType:"application/json; charset=utf-8",dataType:"json"})}swal({title:"Nice!",text:"You saved all changes.",type:"success"},function(){location.reload()})})});